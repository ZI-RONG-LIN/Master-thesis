libname aa"I:\2 USER\SAS匯出資料\HEALTH01"

/*門診篩氣喘*/
%macro s1(f,l);
%do i= &f %to &l;
data OPDTE1&i.;set Tmp1.H_NHI_OPDTE&i._10;
if substr(ICD9CM_1,1,3) = '493' OR substr(ICD9CM_2,1,3) = '493' OR substr(ICD9CM_3,1,3) = '493';
run;
%end;
%mend;
%s1(10601,10612);

%macro s2(f,l);
%do i= &f %to &l;
data OPDTE2&i.;set Tmp1.H_NHI_OPDTE&i._20;
if substr(ICD9CM_1,1,3) = '493' OR substr(ICD9CM_2,1,3) = '493' OR substr(ICD9CM_3,1,3) = '493';
run;
%end;
%mend;
%s2(10601,10612);

%macro s3(f,l);
%do i= &f %to &l;
data OPDTE3&i.;set Tmp1.H_NHI_OPDTE&i._30;
if substr(ICD9CM_1,1,3) = '493' OR substr(ICD9CM_2,1,3) = '493' OR substr(ICD9CM_3,1,3) = '493';
run;
%end;
%mend;
%s3(10601,10612);

/*合併*/
%macro m1;
data aa.OPDTE;
set _null_;
run;
%do k=1%to 3;
%do i=10601 %to 10612;
data aa.OPDTE;
set aa.OPDTE OPDTE&k.&i.;
run;
%end;
%end;
%mend m1;
%m1;

%s1(10501,10512);
%s2(10501,10512);
%s3(10501,10512);
%macro m1;
data aa.OPDTE105;
set _null_;
run;
%do k=1%to 3;
%do i=10501 %to 10512;
data aa.OPDTE105;
set aa.OPDTE105 OPDTE&k.&i.;
run;
%end;
%end;
%mend m1;
%m1;

%s1(10401,10412);
%s2(10401,10412);
%s3(10401,10412);
/*合併*/
%macro m1;
data aa.OPDTE104;
set _null_;
run;
%do k=1%to 3;
%do i=10401 %to 10412;
data aa.OPDTE104;
set aa.OPDTE104 OPDTE&k.&i.;
run;
%end;
%end;
%mend m1;
%m1;

%s1(10301,10312);
%s2(10301,10312);
%s3(10301,10312);
%macro m1;
data aa.OPDTE103;
set _null_;
run;
%do k=1%to 3;
%do i=10301 %to 10312;
data aa.OPDTE103;
set aa.OPDTE103 OPDTE&k.&i.;
run;
%end;
%end;
%mend m1;
%m1;

%s1(10201,10212);
%s2(10201,10212);
%s3(10201,10212);
%macro m1;
data aa.OPDTE102;
set _null_;
run;
%do k=1%to 3;
%do i=10201 %to 10212;
data aa.OPDTE102;
set aa.OPDTE102 OPDTE&k.&i.;
run;
%end;
%end;
%mend m1;
%m1;

%s1(10101,10112);
%s2(10101,10112);
%s3(10101,10112);
%macro m1;
data aa.OPDTE101;
set _null_;
run;
%do k=1%to 3;
%do i=10101 %to 10112;
data aa.OPDTE101;
set aa.OPDTE101 OPDTE&k.&i.;
run;
%end;
%end;
%mend m1;
%m1;

%s1(10001,10012);
%s2(10001,10012);
%s3(10001,10012);
%macro m1;
data aa.OPDTE100;
set _null_;
run;
%do k=1%to 3;
%do i=10001 %to 10012;
data aa.OPDTE100;
set aa.OPDTE100 OPDTE&k.&i.;
run;
%end;
%end;
%mend m1;
%m1;

%s1(9901,9912);
%s2(9901,9912);
%s3(9901,9912);
%macro m1;
data aa.OPDTE99;
set _null_;
run;
%do k=1%to 3;
%do i=9901 %to 9912;
data aa.OPDTE99;
set aa.OPDTE99 OPDTE&k.&i.;
run;
%end;
%end;
%mend m1;
%m1;

%s1(9801,9812);
%s2(9801,9812);
%s3(9801,9812);
%macro m1;
data aa.OPDTE98;
set _null_;
run;
%do k=1%to 3;
%do i=9801 %to 9812;
data aa.OPDTE98;
set aa.OPDTE98 OPDTE&k.&i.;
run;
%end;
%end;
%mend m1;
%m1;
%s1(9701,9712);
%s2(9701,9712);
%s3(9701,9712);
%macro m1;
data aa.OPDTE97;
set _null_;
run;
%do k=1%to 3;
%do i=9701 %to 9712;
data aa.OPDTE97;
set aa.OPDTE97 OPDTE&k.&i.;
run;
%end;
%end;
%mend m1;
%m1;


%s1(9601,9612);
%s2(9601,9612);
%s3(9601,9612);
%macro m1;
data aa.OPDTE96;
set _null_;
run;
%do k=1%to 3;
%do i=9601 %to 9612;
data aa.OPDTE96;
set aa.OPDTE96 OPDTE&k.&i.;
run;
%end;
%end;
%mend m1;
%m1;
